{% extends "layouts/base.html" %}

{% block content %}
<div class="flex h-screen overflow-hidden">
    {% include "includes/closer_sidebar.html" ignore missing %}

    <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-6">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-2xl font-bold text-gray-800 mb-6">Reporte Diario</h1>

            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            {% for category, message in messages %}
            <div
                class="mb-4 p-4 rounded-lg {% if category == 'success' %}bg-green-100 text-green-700 border border-green-200{% else %}bg-red-100 text-red-700 border border-red-200{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
            {% endif %}
            {% endwith %}

            <form method="POST" class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 space-y-8">
                {{ form.hidden_tag() }}

                <!-- Date -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Fecha del Reporte</label>
                    {{ form.date(class="w-full md:w-1/3 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
                    focus:ring-indigo-500 focus:border-indigo-500") }}
                </div>

                <!-- Slots -->
                <div class="border-t pt-4">
                    <h2 class="text-lg font-semibold text-gray-700 mb-4">Disponibilidad</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase">Slots Disponibles</label>
                            {{ form.slots_available(class="w-full px-3 py-2 border border-gray-300 rounded-lg
                            focus:ring-indigo-500") }}
                        </div>
                    </div>
                </div>

                <!-- First Calls -->
                <div class="border-t pt-4">
                    <h2 class="text-lg font-semibold text-gray-700 mb-4">Primeras Agendas (Calls)</h2>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-1">Total Agendas</label>
                            {{ form.first_agendas(class="w-full px-3 py-2 border border-blue-200 bg-blue-50 rounded-lg
                            focus:ring-blue-500") }}
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-1">Asistencias</label>
                            {{ form.first_agendas_attended(class="w-full px-3 py-2 border border-green-200 bg-green-50
                            rounded-lg focus:ring-green-500") }}
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-1">No Show</label>
                            {{ form.first_agendas_no_show(class="w-full px-3 py-2 border border-red-200 bg-red-50
                            rounded-lg focus:ring-red-500") }}
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-1">Reprogramadas</label>
                            {{ form.first_agendas_rescheduled(class="w-full px-3 py-2 border border-yellow-200
                            bg-yellow-50 rounded-lg focus:ring-yellow-500") }}
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-1">Canceladas</label>
                            {{ form.first_agendas_canceled(class="w-full px-3 py-2 border border-gray-300 bg-gray-50
                            rounded-lg focus:ring-gray-500") }}
                        </div>
                    </div>
                </div>

                <!-- Second Calls -->
                <div class="border-t pt-4">
                    <h2 class="text-lg font-semibold text-gray-700 mb-4">Segundas Agendas (Follow-up Calls)</h2>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-1">Total Segundas</label>
                            {{ form.second_agendas(class="w-full px-3 py-2 border border-blue-200 bg-blue-50 rounded-lg
                            focus:ring-blue-500") }}
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-1">Asistencias</label>
                            {{ form.second_agendas_attended(class="w-full px-3 py-2 border border-green-200 bg-green-50
                            rounded-lg focus:ring-green-500") }}
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-1">No Show</label>
                            {{ form.second_agendas_no_show(class="w-full px-3 py-2 border border-red-200 bg-red-50
                            rounded-lg focus:ring-red-500") }}
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-1">Reprogramadas</label>
                            {{ form.second_agendas_rescheduled(class="w-full px-3 py-2 border border-yellow-200
                            bg-yellow-50 rounded-lg focus:ring-yellow-500") }}
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-1">Canceladas</label>
                            {{ form.second_agendas_canceled(class="w-full px-3 py-2 border border-gray-300 bg-gray-50
                            rounded-lg focus:ring-gray-500") }}
                        </div>
                    </div>
                </div>

                <!-- Sales & Activity -->
                <div class="border-t pt-4">
                    <h2 class="text-lg font-semibold text-gray-700 mb-4">Actividad y Ventas</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- Sales -->
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h3 class="text-sm font-bold text-gray-600 mb-3">Ventas</h3>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-xs text-gray-500">Ventas en llamada (1st Call)</label>
                                    {{ form.sales_on_call(class="w-full px-3 py-1 border border-gray-300 rounded") }}
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500">Ventas en seguimiento</label>
                                    {{ form.sales_followup(class="w-full px-3 py-1 border border-gray-300 rounded") }}
                                </div>
                            </div>
                        </div>

                        <!-- CRM Activity -->
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h3 class="text-sm font-bold text-gray-600 mb-3">CRM Activity</h3>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-xs text-gray-500">Seguimientos (Agenda)</label>
                                    {{ form.followups_started_booking(class="w-full px-3 py-1 border border-gray-300
                                    rounded") }}
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500">Seguimientos (Cierre)</label>
                                    {{ form.followups_started_closing(class="w-full px-3 py-1 border border-gray-300
                                    rounded") }}
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500">Respuestas (Agenda)</label>
                                    {{ form.replies_booking(class="w-full px-3 py-1 border border-gray-300 rounded") }}
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500">Respuestas (Venta)</label>
                                    {{ form.replies_sales(class="w-full px-3 py-1 border border-gray-300 rounded") }}
                                </div>
                            </div>
                        </div>

                        <!-- Pipeline -->
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h3 class="text-sm font-bold text-gray-600 mb-3">Pipeline</h3>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-xs text-gray-500">2nd Call Agendada</label>
                                    {{ form.second_calls_booked(class="w-full px-3 py-1 border border-gray-300 rounded")
                                    }}
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500">Agendas Propias</label>
                                    {{ form.self_generated_bookings(class="w-full px-3 py-1 border border-gray-300
                                    rounded") }}
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500">Presentaciones Realizadas</label>
                                    {{ form.presentations(class="w-full px-3 py-1 border border-gray-300 rounded") }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Daily Checklist & Reflection -->
                <div class="border-t pt-4">
                    <h2 class="text-lg font-semibold text-gray-700 mb-4">Reflexión Diaria</h2>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">¿Completaste Notion?</label>
                            {{ form.notion_completed(class="w-full px-4 py-2 border border-gray-300 rounded-lg") }}
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">¿Completaste Objeciones?</label>
                            {{ form.objection_form_completed(class="w-full px-4 py-2 border border-gray-300 rounded-lg")
                            }}
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-green-700 mb-1">Win del día</label>
                            {{ form.win_of_day(class="w-full px-4 py-3 border border-green-200 bg-green-50 rounded-lg
                            focus:ring-green-500", rows="3", placeholder="¿Qué salió bien hoy?") }}
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-indigo-700 mb-1">Cosa a mejorar</label>
                            {{ form.improvement_area(class="w-full px-4 py-3 border border-indigo-200 bg-indigo-50
                            rounded-lg focus:ring-indigo-500", rows="3", placeholder="¿Qué haré mejor mañana?") }}
                        </div>
                    </div>
                </div>

                <div class="flex justify-end pt-4">
                    {{ form.submit(class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-lg
                    shadow-lg hover:shadow-xl transition transform hover:scale-105") }}
                </div>

            </form>
        </div>
    </main>
</div>
{% endblock %}